// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// have to add refresh token and token expiary to primary user
model User {
    id               Int            @id @default(autoincrement())
    email            String         @unique
    login            String
    first_name       String?
    last_name        String?
    game             Game?          @relation("Player")
    opponent         User?          @relation("Opponent", fields: [opponentId], references: [id])
    opponentRelation User?          @relation("Opponent")
    opponentId       Int?           @unique
    // opponents         User[]          @relation("oppenents")
    // oppenentsRelation User[]          @relation("oppenents")
    // opponentsId	  Int[]
    gameRoom         GemeRoom[]     @relation("user")
    GameRecord       MatchHistory[] @relation("user")
    createAt         DateTime       @default(now())
    updateAt         DateTime       @default(now())
}

// model User {
//   id            Int     @id @default(autoincrement())
//   name          String?
//   successor     User?   @relation("BlogOwnerHistory")
//   predecessorId Int?    @unique
//   predecessor   User?   @relation("BlogOwnerHistory", fields: [predecessorId], references: [id])
// }

model GemeRoom {
    id       Int    @id @default(autoincrement())
    roomName String
    game     Game?  @relation("Game")
    user     User[] @relation("user")
}

model Game {
    id           Int       @id @default(autoincrement())
    playerId     Int?      @unique
    player       User?     @relation("Player", fields: [playerId], references: [id])
    gameRoomId   Int?      @unique
    gameRoom     GemeRoom? @relation("Game", fields: [gameRoomId], references: [id])
    side1        Int
    ballX1       Int
    ballY1       Int
    side2        Int
    ballX2       Int
    ballY2       Int
    isPaused     Boolean
    map          Int
    status       Int
    player1Score Int
    player2Score Int
    createAt     DateTime  @default(now())
    updateAt     DateTime  @default(now())
}

// enum Gamestatus {
//   PAUSED
//   PLAYING
//   GAMEOVER
// }

// enum map {
//   MAP1
//   MAP2
//   MAP3
// }

// enum side {
//   LEFT
//   RIGHT
// }

model MatchHistory {
    id        Int      @id @default(autoincrement())
    score     Int
    createdAt DateTime @default(now())
    user      User[]   @relation("user")
}
